[gd_scene load_steps=48 format=3 uid="uid://tjt3wkjp0i5t"]

[ext_resource type="PackedScene" uid="uid://dv81swjibar3c" path="res://Scenes/parallax_background.tscn" id="1_3b8vd"]
[ext_resource type="Script" path="res://Scripts/world.cs" id="1_rvwjb"]
[ext_resource type="Script" path="res://Scripts/Globals.cs" id="2_dtpe5"]
[ext_resource type="PackedScene" uid="uid://bj68a1718682m" path="res://Scenes/player.tscn" id="3_eiu3v"]
[ext_resource type="Script" path="res://Scripts/ResourceDiscoveries.cs" id="4_egxe6"]
[ext_resource type="PackedScene" uid="uid://btwxpde08w643" path="res://Scenes/Resource-IronMine.tscn" id="5_wtxxp"]
[ext_resource type="PackedScene" uid="uid://c410fmb2oa282" path="res://Scenes/resource_template-GoldMine.tscn" id="6_xv0gn"]
[ext_resource type="PackedScene" uid="uid://br0xhpqyxkcjm" path="res://Scenes/resource_template-ManaWell.tscn" id="7_vq3li"]
[ext_resource type="PackedScene" uid="uid://ctcv7jmln8o34" path="res://Scenes/Resource-Wood.tscn" id="8_lwsre"]
[ext_resource type="PackedScene" uid="uid://djjmkb3mx4ata" path="res://Scenes/Resource-Platform.tscn" id="9_woq83"]
[ext_resource type="PackedScene" uid="uid://bhl4p70uusacn" path="res://Scenes/fps.tscn" id="10_2xbt4"]
[ext_resource type="PackedScene" uid="uid://d0rs3cdjkjukh" path="res://Scenes/gui.tscn" id="10_px18i"]
[ext_resource type="Script" path="res://Scripts/SettlementSelect.cs" id="12_cg3fo"]
[ext_resource type="Texture2D" uid="uid://dvgfe0sk66tqs" path="res://Art/GUI/btnAlechemyLab.png" id="13_56blb"]
[ext_resource type="Texture2D" uid="uid://b8wsbb2jt5pyu" path="res://Art/GUI/btnBlacksmith.png" id="14_pyxf8"]
[ext_resource type="Texture2D" uid="uid://ckrrp2gcbqft0" path="res://Art/GUI/btnHerbalist.png" id="15_vdli0"]
[ext_resource type="Texture2D" uid="uid://dnas3wtclg63g" path="res://Art/GUI/btnLodestone.png" id="16_2nuhw"]
[ext_resource type="Texture2D" uid="uid://3uf26qhnwybg" path="res://Art/GUI/btnSettlement.png" id="17_ycron"]
[ext_resource type="Texture2D" uid="uid://boifd3b0kaqav" path="res://Art/GUI/btnTower.png" id="18_qjudb"]
[ext_resource type="Texture2D" uid="uid://b3gh0i468gumr" path="res://Art/GUI/btnTrainingCenter.png" id="19_r8ow7"]
[ext_resource type="PackedScene" uid="uid://b7cdceuynn4co" path="res://Scenes/Structure-AlchemyLab.tscn" id="20_dtrsa"]
[ext_resource type="Texture2D" uid="uid://dq7yb4v644n7e" path="res://Art/GUI/Button.png" id="20_vu2nf"]
[ext_resource type="PackedScene" uid="uid://cx15v303xmpy6" path="res://Scenes/Structure-Blacksmith.tscn" id="21_xq308"]
[ext_resource type="PackedScene" uid="uid://ckakgnegnrlvf" path="res://Scenes/Structure-Herbalist.tscn" id="22_xxl8y"]
[ext_resource type="PackedScene" uid="uid://b2e4ek01eon7f" path="res://Scenes/Structure-Lodestone.tscn" id="23_w70wf"]
[ext_resource type="PackedScene" uid="uid://cs70lx50ngyvy" path="res://Scenes/Structure-Settlement.tscn" id="24_ek7ss"]
[ext_resource type="PackedScene" uid="uid://pv0fpyslcgie" path="res://Scenes/Structure-Tower.tscn" id="25_d0kw3"]
[ext_resource type="PackedScene" uid="uid://bcn0ebog5s0ps" path="res://Scenes/Structure-TrainingCenter.tscn" id="26_e2j4s"]
[ext_resource type="Texture2D" uid="uid://bq4pom8h1qihh" path="res://Art/GUI/IronOre.png" id="28_mqoqv"]
[ext_resource type="Texture2D" uid="uid://ke85s64nnx0g" path="res://Art/GUI/Wood.png" id="29_eowbu"]
[ext_resource type="Texture2D" uid="uid://bkjl0vf4gs5nm" path="res://Art/GUI/RedStroke.png" id="30_w6xib"]
[ext_resource type="PackedScene" uid="uid://bgvm1ptpi8lca" path="res://Scenes/fog.tscn" id="31_3wxrh"]
[ext_resource type="PackedScene" uid="uid://03rf0tmt2nd5" path="res://Scenes/FogOfWar.tscn" id="31_aslyk"]
[ext_resource type="Script" path="res://Scripts/FogOfWar.cs" id="32_f36kf"]
[ext_resource type="Texture2D" uid="uid://dw6baw0ypmyb0" path="res://Art/Light.png" id="33_0wlbc"]
[ext_resource type="PackedScene" uid="uid://1xxnq480idry" path="res://Scenes/fo_wfog.tscn" id="35_p0u56"]
[ext_resource type="PackedScene" uid="uid://dfcendwn41quo" path="res://Scenes/MiniMap.tscn" id="36_hw51v"]
[ext_resource type="PackedScene" uid="uid://bpukysafnurai" path="res://black.tscn" id="38_b7fsk"]

[sub_resource type="Environment" id="Environment_h8lsd"]
background_mode = 3
tonemap_mode = 3
glow_enabled = true
glow_intensity = 0.75
glow_strength = 0.76
glow_bloom = 1.0
glow_blend_mode = 0
glow_hdr_threshold = 0.17
glow_hdr_scale = 0.36
glow_hdr_luminance_cap = 0.04
glow_map_strength = 0.0
adjustment_enabled = true

[sub_resource type="Gradient" id="Gradient_bydhu"]
offsets = PackedFloat32Array(0, 0.63871)
colors = PackedColorArray(1, 1, 1, 1, 0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_bih6r"]
gradient = SubResource("Gradient_bydhu")
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="Curve2D" id="Curve2D_obham"]
_data = {
"points": PackedVector2Array(41.38, -3.3371, -41.38, 3.3371, 1063, 588, 0, 0, 0, 0, -1026, 583, 0, 0, 0, 0, -1030, -616, 0, 0, 0, 0, 1061, -613, -0.0278406, -3.9812, 0.0278406, 3.9812, 1063, 588)
}
point_count = 5

[sub_resource type="LabelSettings" id="LabelSettings_lonnw"]
font_size = 32

[sub_resource type="LabelSettings" id="LabelSettings_56d7c"]
font_size = 28

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_hvd18"]
bg_color = Color(0.462745, 0.329412, 0, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_ndxlt"]
bg_color = Color(1, 0.737255, 0.0980392, 1)

[sub_resource type="LabelSettings" id="LabelSettings_7qdhh"]
font_size = 20
outline_size = 2

[node name="World" type="Node2D" node_paths=PackedStringArray("EnemySpawnPath")]
y_sort_enabled = true
script = ExtResource("1_rvwjb")
EnemySpawnPath = NodePath("Player/Path2D/EnemySpawnPath")

[node name="Globals" type="Node2D" parent="."]
script = ExtResource("2_dtpe5")

[node name="FPS" parent="." instance=ExtResource("10_2xbt4")]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_h8lsd")

[node name="Fog" parent="WorldEnvironment" instance=ExtResource("31_3wxrh")]

[node name="AmbientLight" type="DirectionalLight2D" parent="WorldEnvironment"]
energy = 0.2
blend_mode = 1

[node name="ParallaxBackground" parent="." instance=ExtResource("1_3b8vd")]
scale = Vector2(1, 1)
transform = Transform2D(1, 0, 0, 1, 0, 0)

[node name="ResourceDiscoveries" type="Node2D" parent="."]
y_sort_enabled = true
position = Vector2(142, -55)
script = ExtResource("4_egxe6")
rTemplateIronMine = ExtResource("5_wtxxp")
rTemplateGoldMine = ExtResource("6_xv0gn")
rTemplateManaWell = ExtResource("7_vq3li")
rTemplateWood = ExtResource("8_lwsre")
rTemplatePlatform = ExtResource("9_woq83")
resourcesPerCell = 6
resourceUpdateFreq = 60

[node name="Timer" type="Timer" parent="ResourceDiscoveries"]
autostart = true

[node name="Structures" type="Node2D" parent="."]
y_sort_enabled = true

[node name="EnemyTimer" type="Timer" parent="."]
wait_time = 0.5
autostart = true

[node name="Player" parent="." instance=ExtResource("3_eiu3v")]
texture_filter = 1
scale = Vector2(0.5, 0.5)
Speed = 300
DashSpeed = 1200.0
DashDuration = 0.3

[node name="AnimatedSprite2D" parent="Player" index="1"]
frame_progress = 0.275089

[node name="PointLight2D" type="PointLight2D" parent="Player"]
position = Vector2(0, -84)
scale = Vector2(8, 8)
color = Color(0.988235, 0.984314, 0, 1)
energy = 0.2
texture = SubResource("GradientTexture2D_bih6r")

[node name="Path2D" type="Path2D" parent="Player"]
scale = Vector2(2, 2)
curve = SubResource("Curve2D_obham")

[node name="EnemySpawnPath" type="PathFollow2D" parent="Player/Path2D"]
unique_name_in_owner = true
position = Vector2(1063, 588)
rotation = 3.06112

[node name="GUI" parent="." instance=ExtResource("10_px18i")]

[node name="StructureGUI" type="CanvasLayer" parent="GUI"]

[node name="SettlementSelect" type="CanvasGroup" parent="GUI/StructureGUI" node_paths=PackedStringArray("btnNode0", "btnNode1", "btnNode2", "btnNode3", "lblIron", "lblWood", "redStroke", "lblCurStruct")]
position = Vector2(854, 546)
script = ExtResource("12_cg3fo")
btnNode0 = NodePath("btn0")
btnNode1 = NodePath("btn1")
btnNode2 = NodePath("btn2")
btnNode3 = NodePath("btn3")
txStructBut = Array[Texture2D]([ExtResource("13_56blb"), ExtResource("14_pyxf8"), ExtResource("15_vdli0"), ExtResource("16_2nuhw"), ExtResource("17_ycron"), ExtResource("18_qjudb"), ExtResource("19_r8ow7")])
scnStruct = Array[PackedScene]([ExtResource("20_dtrsa"), ExtResource("21_xq308"), ExtResource("22_xxl8y"), ExtResource("23_w70wf"), ExtResource("24_ek7ss"), ExtResource("25_d0kw3"), ExtResource("26_e2j4s")])
lblIron = NodePath("lblIron")
lblWood = NodePath("lblWood")
costIron = PackedInt32Array(1, 2, 3, 2, 4, 4, 3)
costWood = PackedInt32Array(1, 2, 0, 4, 2, 6, 3)
redStroke = NodePath("RedStroke")
lblCurStruct = NodePath("Label")

[node name="btn0" type="TextureRect" parent="GUI/StructureGUI/SettlementSelect"]
z_index = 1
offset_left = -115.0
offset_top = 85.0
offset_right = 77.0
offset_bottom = 266.0
scale = Vector2(0.5, 0.5)
mouse_filter = 0
mouse_force_pass_scroll_events = false
texture = ExtResource("18_qjudb")
metadata/_edit_use_anchors_ = true

[node name="btn1" type="TextureRect" parent="GUI/StructureGUI/SettlementSelect"]
z_index = 1
offset_right = 40.0
offset_bottom = 40.0
texture = ExtResource("13_56blb")
metadata/_edit_use_anchors_ = true

[node name="btn2" type="TextureRect" parent="GUI/StructureGUI/SettlementSelect"]
z_index = 1
offset_left = 212.0
offset_top = 85.0
offset_right = 404.0
offset_bottom = 266.0
scale = Vector2(0.5, 0.5)
mouse_force_pass_scroll_events = false
texture = ExtResource("17_ycron")
metadata/_edit_use_anchors_ = true

[node name="btn3" type="TextureRect" parent="GUI/StructureGUI/SettlementSelect"]
z_index = 1
offset_left = -118.0
offset_top = -13.0
offset_right = 74.0
offset_bottom = 168.0
scale = Vector2(0.5, 0.5)
texture = ExtResource("20_vu2nf")
metadata/_edit_use_anchors_ = true

[node name="Label" type="Label" parent="GUI/StructureGUI/SettlementSelect"]
visible = false
offset_left = 47.0
offset_top = 232.0
offset_right = 110.0
offset_bottom = 280.0
text = "Cur:"
label_settings = SubResource("LabelSettings_lonnw")
metadata/_edit_use_anchors_ = true

[node name="Iron" type="TextureRect" parent="GUI/StructureGUI/SettlementSelect"]
offset_left = -38.0
offset_top = 187.0
offset_right = 96.0
offset_bottom = 285.0
scale = Vector2(0.5, 0.5)
texture = ExtResource("28_mqoqv")

[node name="lblIron" type="Label" parent="GUI/StructureGUI/SettlementSelect"]
offset_left = 34.0
offset_top = 194.0
offset_right = 82.0
offset_bottom = 236.0
text = "999"
label_settings = SubResource("LabelSettings_56d7c")

[node name="Wood" type="TextureRect" parent="GUI/StructureGUI/SettlementSelect"]
offset_left = 103.0
offset_top = 188.0
offset_right = 237.0
offset_bottom = 286.0
scale = Vector2(0.5, 0.5)
texture = ExtResource("29_eowbu")

[node name="lblWood" type="Label" parent="GUI/StructureGUI/SettlementSelect"]
offset_left = 181.0
offset_top = 194.0
offset_right = 229.0
offset_bottom = 236.0
text = "999"
label_settings = SubResource("LabelSettings_56d7c")

[node name="RedStroke" type="TextureRect" parent="GUI/StructureGUI/SettlementSelect"]
visible = false
z_index = 2
offset_right = 40.0
offset_bottom = 40.0
texture = ExtResource("30_w6xib")

[node name="XPBar" type="ProgressBar" parent="GUI"]
z_index = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -800.0
offset_top = 13.0
offset_right = 800.0
offset_bottom = 33.0
grow_horizontal = 2
theme_override_styles/background = SubResource("StyleBoxFlat_hvd18")
theme_override_styles/fill = SubResource("StyleBoxFlat_ndxlt")
max_value = 1.0
value = 1.0
show_percentage = false

[node name="Label" type="Label" parent="GUI/XPBar"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -52.0
offset_top = -5.0
offset_bottom = 26.0
grow_horizontal = 0
text = "Level"
label_settings = SubResource("LabelSettings_7qdhh")

[node name="FogOfWar" parent="." node_paths=PackedStringArray("fog", "Player") instance=ExtResource("31_aslyk")]
visible = true
z_index = 10
scale = Vector2(14, 14)
script = ExtResource("32_f36kf")
fog = NodePath("FoWfog")
fogWidth = 4200
fogHeight = 2600
LightTexture = ExtResource("33_0wlbc")
lightWidth = 100
lightHeight = 100
Player = NodePath("../Player")
debounce_time = 0.2

[node name="FoWfog" parent="FogOfWar" instance=ExtResource("35_p0u56")]
position = Vector2(-1949, -1206)

[node name="MiniMapCanvas" type="CanvasLayer" parent="."]

[node name="Control" type="Control" parent="MiniMapCanvas"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = -1120.0
offset_bottom = -480.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 8
size_flags_vertical = 8

[node name="SubViewportContainer" parent="MiniMapCanvas/Control" instance=ExtResource("36_hw51v")]
layout_mode = 1
offset_left = 1163.0
offset_top = 468.0
offset_right = 1111.0
offset_bottom = 467.998

[node name="Bullets" type="Node2D" parent="."]

[node name="Items" type="Node2D" parent="."]

[node name="Enemies" type="Node2D" parent="."]

[node name="Black" parent="." instance=ExtResource("38_b7fsk")]

[connection signal="timeout" from="ResourceDiscoveries/Timer" to="ResourceDiscoveries" method="OnTimer"]
[connection signal="timeout" from="EnemyTimer" to="." method="_on_enemy_timer_timeout"]
[connection signal="visibility_changed" from="GUI/StructureGUI/SettlementSelect" to="GUI/StructureGUI/SettlementSelect" method="_on_visibility_changed"]
[connection signal="mouse_entered" from="GUI/StructureGUI/SettlementSelect/btn0" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_0_mouse_entered"]
[connection signal="mouse_exited" from="GUI/StructureGUI/SettlementSelect/btn0" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_0_mouse_exited"]
[connection signal="mouse_entered" from="GUI/StructureGUI/SettlementSelect/btn1" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_1_mouse_entered"]
[connection signal="mouse_exited" from="GUI/StructureGUI/SettlementSelect/btn1" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_1_mouse_exited"]
[connection signal="mouse_entered" from="GUI/StructureGUI/SettlementSelect/btn2" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_2_mouse_entered"]
[connection signal="mouse_exited" from="GUI/StructureGUI/SettlementSelect/btn2" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_2_mouse_exited"]
[connection signal="mouse_entered" from="GUI/StructureGUI/SettlementSelect/btn3" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_0_mouse_entered"]
[connection signal="mouse_exited" from="GUI/StructureGUI/SettlementSelect/btn3" to="GUI/StructureGUI/SettlementSelect" method="_on_btn_0_mouse_exited"]

[editable path="Player"]
